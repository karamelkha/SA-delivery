# 02-process-modeling

Данный раздел содержит BPMN-модели бизнес-процессов информационной системы сервиса доставки еды «Delivery».

Диаграммы описывают процессное поведение системы и участников и используются для формализации жизненного цикла заказа, проверки требований и проектирования логики обработки заказов.

Модели разработаны в нотации BPMN 2.0.

---

## 1. Назначение раздела

BPMN-модели используются для:

- описания жизненного цикла заказа от оформления до завершения;
- фиксации ответственности ролей (Клиент, Система, Ресторан, Курьер, Администратор);
- моделирования интеграции с платёжным сервисом;
- формализации таймеров, эскалаций и исключительных сценариев;
- валидации требований (FR, UC, BR, статусов).

Диаграммы являются процессным представлением требований, описанных в документах Functional Requirements, Use Case, Business Rules и Order Statuses.

---

## 2. Архитектура процессов

Процессы организованы по принципу:

**Сквозной процесс + декомпозированные подпроцессы**

Сквозной процесс описывает общий поток обработки заказа.  
Подпроцессы используются для детализации логически сложных этапов без перегрузки основной диаграммы.

---

## 3. Сквозной процесс — Main

Диаграмма **Main** описывает полный жизненный цикл заказа.

#### Ссылка на диаграмму: https://modeler.camunda.io/share/9d2f847a-e9d8-4cb6-86a5-50b1e97d380f

Процесс начинается с оформления заказа клиентом и завершается доставкой или отменой заказа.

В рамках процесса моделируются следующие этапы:

- выбор ресторана и формирование заказа клиентом;
- создание заказа и перевод в статус «Ожидает оплаты»;
- выполнение онлайн-оплаты через подпроцесс `Payment_Process`;
- передача оплаченного заказа ресторану;
- подтверждение заказа рестораном;
- приготовление заказа;
- перевод заказа в статус «Готов к доставке»;
- назначение курьера через подпроцесс `Courier_Assignment_Process`;
- доставка заказа курьером;
- завершение заказа в статусе «Доставлен» либо «Отменён».

Диаграмма отражает все ключевые переходы статусов, определённые в `Order_Statuses.md`.

---

## 4. Подпроцесс — Payment_Process

Подпроцесс `Payment_Process` описывает обработку онлайн-оплаты заказа.

#### Ссылка на диаграмму: https://modeler.camunda.io/share/f4a02d18-4519-4a6f-89de-6e4b451786f2

Процесс запускается после создания заказа и перевода его в статус «Ожидает оплаты».

В рамках подпроцесса выполняется:

- формирование платёжных данных;
- передача данных в платёжный сервис;
- ожидание результата оплаты;
- контроль лимита времени оплаты (15 минут);
- обработка успешной оплаты с переводом заказа в статус «Оплачен»;
- обработка неуспешной или не выполненной оплаты с переводом заказа в статус «Заказ не оплачен»;
- сохранение результата оплаты.

Платёжный сервис моделируется как внешняя система (black box) через message events.

---

## 5. Подпроцесс — Courier_Assignment_Process

Подпроцесс `Courier_Assignment_Process` описывает назначение курьера для доставки заказа.

#### Ссылка на диаграмму: https://modeler.camunda.io/share/bbd757bd-b13e-4f03-8913-e4940ce022ba

Процесс запускается после перевода заказа в статус «Готов к доставке».

В рамках подпроцесса выполняется:

- перевод заказа в статус «Ожидает назначения курьера»;
- автоматический поиск доступного курьера;
- повторные попытки назначения курьера с использованием таймера;
- контроль максимального времени назначения курьера;
- обработка ситуации, когда курьер не был назначен;
- перевод заказа в статус «Курьер не назначен»;
- уведомление администратора;
- принятие администратором решения:
  - отменить заказ;
  - или назначить курьера вручную;
- перевод заказа в статус «В пути» при успешном назначении курьера.

Подпроцесс возвращает в основной процесс один из следующих результатов:

- курьер назначен, заказ переходит к доставке;
- заказ отменён по решению администратора.

---

## 6. Принципы моделирования

В BPMN-моделях применяются следующие принципы:

- ответственность ролей представлена с помощью дорожек (lanes);
- внешние системы моделируются как black box через message flows;
- таймеры используются для ограничения времени выполнения операций и эскалаций;
- переходы статусов соответствуют документу `Order_Statuses.md`.

---

## 7. Связь с требованиями

BPMN-диаграммы реализуют поведение, описанное в:

- Functional Requirements;
- Use Case;
- Business Rules;
- Order Statuses.

Связь процессов с требованиями и сценариями зафиксирована в `Traceability_Matrix.md`.
