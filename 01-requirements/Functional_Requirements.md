# Functional Requirements

## 1. Общие положения

Настоящий документ содержит функциональные требования к информационной системе сервиса доставки еды «Delivery».

Функциональные требования определяют поведение системы в части обработки заказов, оплаты, доставки и администрирования.
Документ не содержит требований к пользовательскому интерфейсу, нефункциональных требований и детальных воздействий.

Статусы заказа и допустимые переходы описаны в документе `Order_Statuses.md`.
Бизнес-правила описаны в документе `Business_Rules.md`.

---

## 2. Роли пользователей и внешних систем

В системе предусмотрены следующие роли:

- **Клиент** — пользователь, оформляющий и оплачивающий заказ
- **Курьер** — пользователь, осуществляющий доставку заказа
- **Ресторан** — участник системы, принимающий и готовящий заказ
- **Администратор** — пользователь, управляющий системой

В системе также используется внешняя система:

- **Платёжный сервис** — внешний сервис для обработки онлайн-оплаты заказов

---

## 3. Функциональные требования

### 3.1 Работа с ресторанами и меню

FR-1. Система должна предоставлять клиенту возможность просматривать список доступных ресторанов.

FR-2. Система должна предоставлять клиенту возможность просматривать меню выбранного ресторана.

---

### 3.2 Оформление заказа клиентом

FR-3. Система должна позволять клиенту добавлять блюда в корзину.

FR-4. Система должна позволять клиенту изменять состав корзины до оформления заказа.

FR-5. Система должна рассчитывать итоговую стоимость корзины.

FR-6. Система должна создать заказ при оформлении клиентом.

FR-7. Система должна присваивать созданному заказу уникальный идентификатор.

FR-8. Система должна переводить заказ в статус «Ожидает оплаты» после его создания.

---

### 3.3 Онлайн-оплата заказа

FR-9. Система должна предоставлять клиенту возможность инициировать онлайн-оплату заказа.

FR-10. Система должна передавать в платёжный сервис данные, необходимые для выполнения оплаты заказа.

FR-11. Система должна получать от платёжного сервиса результат оплаты заказа (успешно / неуспешно).

FR-12. Система должна сохранять статус оплаты заказа.

FR-13. Система должна контролировать время ожидания оплаты заказа в соответствии с бизнес-правилами.

FR-14. При успешной оплате система должна переводить заказ в статус «Оплачен».

FR-15. При истечении времени ожидания оплаты система должна переводить заказ в статус «Заказ не оплачен».

FR-16. При неуспешной оплате система должна сохранять статус оплаты «Оплата не прошла» и оставлять заказ в статусе «Ожидает оплаты» до истечения времени ожидания оплаты.

FR-17. Система должна передавать оплаченный заказ в ресторан.

FR-18. Система должна обеспечивать устойчивую обработку результатов оплаты заказа, исключая дублирование заказов и некорректные переходы статусов.

---

### 3.4 Обработка заказа рестораном

FR-19. Система должна предоставлять ресторану информацию об оплаченных заказах.

FR-20. Система должна принимать от ресторана решение о подтверждении или отклонении заказа.

FR-21. При подтверждении заказа система должна переводить заказ в статус «Подтверждён рестораном».

FR-22. При отклонении заказа система должна переводить заказ в статус «Отклонён».

FR-23. После завершения приготовления заказа система должна переводить заказ в статус «Готов к доставке».

---

### 3.5 Назначение курьера и доставка

FR-24. После перевода заказа в статус «Готов к доставке» система должна переводить заказ в статус «Ожидает назначения курьера» и запускать процесс назначения курьера.

FR-25. Система должна выполнять автоматическое назначение курьера на заказ в статусе «Ожидает назначения курьера».

FR-26. Система должна предоставлять курьеру информацию о назначенном заказе и адресе доставки.

FR-27. Система должна выполнять повторные попытки назначения курьера в рамках процесса назначения курьера до истечения времени назначения курьера или до успешного назначения.

FR-28. При назначении курьера система должна фиксировать назначение курьера на заказ.

FR-29. После подтверждения получения заказа курьером система должна переводить заказ в статус «В пути».

FR-30. Система должна позволять курьеру переводить заказ в статус «Доставлен».

FR-31. Система должна сохранять изменения статусов заказа и историю изменений.

FR-32. При невозможности доставки система должна сохранять событие «Доставка не выполнена» с указанием причины.

---

### 3.6 Обработка исключительных ситуаций доставки

FR-33. Если курьер не назначен в течение времени, установленного бизнес-правилами, система должна переводить заказ в статус «Курьер не назначен».

FR-34. В случае статуса «Курьер не назначен» система должна уведомлять администратора.

FR-35. Система должна предоставлять администратору возможность назначить курьера вручную.

FR-36. Система должна предоставлять администратору возможность отменить заказ.

---

### 3.7 Информирование пользователей

FR-37. Система должна предоставлять клиенту возможность получать актуальный статус заказа при обращении к заказу.

FR-38. Система должна предоставлять курьеру и администратору доступ к актуальному статусу заказа в рамках их роли.

---

### 3.8 Администрирование

FR-39. Система должна предоставлять администратору доступ к информации о заказах.

FR-40. Система должна предоставлять администратору возможность просматривать историю изменений заказов.

FR-41. Система должна предоставлять администратору возможность управления пользователями системы.

---

## 4. Ограничения

- Возвраты и частичные возвраты платежей находятся вне рамок проекта.
- Система не выполняет расчёт маршрутов доставки.
- Детальная проработка пользовательских интерфейсов не входит в рамки проекта.
